<!DOCTYPE html>
<html lang="ru">
<head>
  <!-- 1. –ú–µ—Ç–∞-—Ç–µ–≥–∏ –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∫–∏ –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AstroPred Mini App</title>
  
  <!-- 2. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫ -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.css">
  
  <!-- 3. –°—Ç–∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
  <style>
    /* 3.1 CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) */
    :root {
      --primary-color: #9370db;
      --secondary-color: #6a5acd;
      --text-color: #f0f0f0;
      --bg-color: #0a0a1a;
      --card-color: rgba(22, 33, 62, 0.8);
      --error-color: #ff6b6b;
      --success-color: #4caf50;
      --info-color: #4285f4;
      --warning-color: #ff9800;
      --panel-width: 75%;
      --transition-speed: 0.3s;
    }
    
    /* 3.2 CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º—ã */
    :root.light-theme {
      --primary-color: #6a5acd;
      --secondary-color: #483d8b;
      --text-color: #333333;
      --bg-color: #f5f5f5;
      --card-color: rgba(255, 255, 255, 0.9);
      --error-color: #e74c3c;
      --success-color: #27ae60;
      --info-color: #3498db;
      --warning-color: #f39c12;
    }
    
    /* 3.3 –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ —Ç–µ–ª–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ */
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      color: var(--text-color);
      background: var(--bg-color);
      transition: all var(--transition-speed) ease;
      position: relative;
      overflow-x: hidden;
      min-height: 100vh;
    }
    
    /* 3.4 –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∑–≤–µ–∑–¥–Ω–æ–≥–æ —Ñ–æ–Ω–∞ */
    #stars-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
    }
    
    /* 3.5 –°—Ç–∏–ª–∏ –¥–ª—è –∑–≤–µ–∑–¥ */
    .star {
      position: absolute;
      background-color: var(--text-color);
      border-radius: 50%;
      animation: twinkle var(--duration) infinite ease-in-out;
    }
    
    /* 3.6 –ê–Ω–∏–º–∞—Ü–∏—è –º–µ—Ä—Ü–∞–Ω–∏—è –∑–≤–µ–∑–¥ */
    @keyframes twinkle {
      0%, 100% { opacity: 0.2; }
      50% { opacity: 1; }
    }
    
    /* 3.7 –°—Ç–∏–ª–∏ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é */
    #mainMenu {
      padding: 20px;
      transition: all var(--transition-speed) ease;
      position: relative;
      z-index: 1;
      padding-bottom: 120px;
    }
    
    /* 3.8 –°—Ç–∏–ª—å –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∞–Ω–∫–µ—Ç—ã */
    .side-panel > h2 {
      margin-top: 0;
      padding-top: 10px;
    }
    
    /* 3.9 –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ª–æ–≥–æ—Ç–∏–ø–∞ */
    .logo-container {
      text-align: center;
      margin-bottom: 30px;
      cursor: pointer;
    }
    
    /* 3.10 –°—Ç–∏–ª–∏ SVG –ª–æ–≥–æ—Ç–∏–ø–∞ */
    .logo-svg {
      width: 120px;
      height: 120px;
      margin-bottom: 15px;
    }
    
    /* 3.11 –¢–µ–∫—Å—Ç –ª–æ–≥–æ—Ç–∏–ø–∞ */
    .logo-text {
      font-size: 28px;
      font-weight: bold;
      color: var(--primary-color);
      margin-top: 10px;
    }
    
    /* 3.12 –°—Ç–∏–ª–∏ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é */
    .main-menu {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-top: 20px;
    }
    
    /* 3.13 –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å */
    .side-panel {
      position: fixed;
      top: 0;
      right: -100%;
      width: var(--panel-width);
      height: 100vh;
      background: var(--bg-color);
      box-shadow: -5px 0 15px rgba(0,0,0,0.3);
      z-index: 100;
      overflow-y: auto;
      transition: right var(--transition-speed) ease;
      padding: 50px 20px 20px;
      border-left: 1px solid rgba(255,255,255,0.1);
    }
    
    /* 3.14 –ê–∫—Ç–∏–≤–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏ */
    .side-panel.active {
      right: 0;
    }
    
    /* 3.15 –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–∞–Ω–µ–ª–∏ */
    .close-panel {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      color: var(--text-color);
      font-size: 24px;
      cursor: pointer;
    }
    
    /* 3.16 –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ –∫–Ω–æ–ø–æ–∫ */
    .btn {
      position: relative;
      overflow: hidden;
      padding: 14px 20px;
      border-radius: 12px;
      border: none;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      background-color: var(--primary-color);
      color: white;
    }
    
    /* 3.17 –°–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–æ–∫ */
    .btn:hover {
      background-color: var(--secondary-color);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    
    .btn:active {
      transform: translateY(0);
    }
    
    .btn:disabled {
      background-color: #555;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    /* 3.18 –°—Ç–∏–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–Ω–æ–ø–æ–∫ */
    .btn-success {
      background-color: var(--success-color);
    }
    
    .btn-error {
      background-color: var(--error-color);
    }
    
    .btn-info {
      background-color: var(--info-color);
    }
    
    .btn-warning {
      background-color: var(--warning-color);
    }
    
    /* 3.19 –≠—Ñ—Ñ–µ–∫—Ç ripple –¥–ª—è –∫–Ω–æ–ø–æ–∫ */
    .btn::after {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      width: 5px;
      height: 5px;
      background: rgba(255, 255, 255, 0.5);
      opacity: 0;
      border-radius: 100%;
      transform: scale(1, 1) translate(-50%, -50%);
      transform-origin: 50% 50%;
    }
    
    .btn:focus:not(:active)::after {
      animation: ripple 0.6s ease-out;
    }
    
    /* 3.20 –ê–Ω–∏–º–∞—Ü–∏—è ripple —ç—Ñ—Ñ–µ–∫—Ç–∞ */
    @keyframes ripple {
      0% {
        transform: scale(0, 0);
        opacity: 0.5;
      }
      100% {
        transform: scale(20, 20);
        opacity: 0;
      }
    }
    
    /* 3.21 –°—Ç–∏–ª–∏ —Ñ–æ—Ä–º */
    form {
      display: flex;
      flex-direction: column;
      gap: 20px;
      background: var(--card-color);
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
      transition: all var(--transition-speed) ease;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255,255,255,0.1);
    }
    
    /* 3.22 –ì—Ä—É–ø–ø—ã –ø–æ–ª–µ–π —Ñ–æ—Ä–º—ã */
    .form-group {
      position: relative;
      animation: fadeIn 0.5s ease forwards;
      opacity: 0;
    }
    
    /* 3.23 –°—Ç–∏–ª–∏ –º–µ—Ç–æ–∫ */
    label {
      font-weight: 600;
      display: block;
      margin-bottom: 8px;
      color: var(--text-color);
    }
    
    label i {
      margin-right: 8px;
      color: var(--primary-color);
      width: 20px;
      text-align: center;
    }
    
    /* 3.24 –°—Ç–∏–ª–∏ –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ */
    input, select, textarea {
      padding: 12px 15px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.2);
      font-size: 16px;
      width: 100%;
      box-sizing: border-box;
      background: rgba(0,0,0,0.3);
      color: var(--text-color);
      transition: all var(--transition-speed) ease;
    }

    /* –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ –¥–ª—è select: –¥–æ–±–∞–≤–∏–º —Å—Ç—Ä–µ–ª–æ—á–∫—É */
    select {
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg fill='%23cccccc' height='24' viewBox='0 0 24 24' width='24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
      background-size: 18px 18px;
      padding-right: 40px;
      cursor: pointer;
    }
  
    /* 3.25 –°–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ */
    input:focus, select:focus, textarea:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 2px rgba(106, 90, 205, 0.3);
      outline: none;
    }
    
    input:invalid, select:invalid {
      border-color: var(--error-color);
    }
    
    /* 3.26 –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞ */
    .progress-container {
      width: 100%;
      background: rgba(0,0,0,0.2);
      border-radius: 10px;
      margin-bottom: 20px;
      overflow: hidden;
    }
    
    /* 3.27 –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä */
    .progress-bar {
      height: 8px;
      background: var(--primary-color);
      border-radius: 10px;
      transition: width 0.4s ease;
    }
    
    /* 3.28 –®–∞–≥–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ */
    .progress-steps {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
      font-size: 14px;
      color: var(--text-color);
    }
    
    /* 3.29 –°—Ç–∏–ª–∏ —à–∞–≥–æ–≤ */
    .step {
      text-align: center;
      flex: 1;
      position: relative;
    }
    
    .step.active {
      color: var(--primary-color);
      font-weight: bold;
    }
    
    .step.completed::before {
      content: "‚úì";
      color: var(--success-color);
      margin-right: 5px;
    }
    
    /* 3.30 –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–æ–≥–Ω–æ–∑–∞ */
    .forecast-container {
      background: var(--card-color);
      padding: 25px;
      border-radius: 15px;
      margin-top: 20px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255,255,255,0.1);
      animation: slideUp 0.5s ease forwards;
    }
    
    /* 3.31 –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–æ–≥–Ω–æ–∑–∞ */
    .forecast-header {
      text-align: center;
      margin-bottom: 20px;
      color: var(--primary-color);
    }
    
    /* 3.32 –ö–æ–Ω—Ç–µ–Ω—Ç –ø—Ä–æ–≥–Ω–æ–∑–∞ */
    .forecast-content {
      line-height: 1.6;
    }
    
    /* 3.33 –°–µ–∫—Ü–∏–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞ */
    .forecast-section {
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px dashed rgba(255,255,255,0.1);
    }
    
    /* 3.34 –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Å–µ–∫—Ü–∏–π */
    .forecast-section h3 {
      color: var(--primary-color);
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    /* 3.35 –ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ñ–∏–ª—è */
    .profile-view {
      background: var(--card-color);
      padding: 25px;
      border-radius: 15px;
      margin-top: 20px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255,255,255,0.1);
    }
    
    /* 3.36 –ó–∞–≥–æ–ª–æ–≤–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è */
    .profile-view h3 {
      color: var(--primary-color);
      margin-bottom: 20px 0 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    /* 3.37 –ü–∞—Ä–∞–≥—Ä–∞—Ñ—ã –ø—Ä–æ—Ñ–∏–ª—è */
    .profile-view p {
      margin-bottom: 10px;
      padding-left: 10px;
    }
    
    /* 3.38 –ö–Ω–æ–ø–∫–∏ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" */
    .share-buttons {
      display: flex;
      gap: 10px;
      margin-top: 20px;
      justify-content: space-between;
    }

    .share-buttons .btn {
      flex: 1;
      min-width: 0;
    }
    
    /* 3.39 –ö–Ω–æ–ø–∫–∏ –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞ */
    .bottom-buttons {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: calc(100% - 40px);
      max-width: 400px;
      z-index: 10;
      display: flex;
      flex-direction: column;
      gap: 10px;
      padding-bottom: env(safe-area-inset-bottom);
    }
    
    /* 3.40 –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ñ–æ—Ä–º–µ */
    .form-navigation {
      display: flex;
      justify-content: space-between;
      gap: 20px;
      margin-top: 20px;
    }
    
    .form-navigation .btn {
      flex: 1;
    }
    
    /* 3.41 –ë–æ–Ω—É—Å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ */
    .bonus-message {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) !important;
      width: calc(100% - 40px);
      max-width: 400px;
      box-sizing: border-box;
      padding: 20px;
      background: var(--card-color);
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
      z-index: 1000;
      text-align: center;
      display: none;
      overflow: visible;
      white-space: normal;
    }
    
    .bonus-message h3 {
      color: var(--primary-color);
      margin-bottom: 10px;
    }
    
    .bonus-message p {
      line-height: 1.6;
    }
    
    .bonus-message .close-bonus {
      position: absolute;
      top: 10px;
      right: 10px;
      background: none;
      border: none;
      color: var(--text-color);
      font-size: 18px;
      cursor: pointer;
    }
    
    /* 3.42 –û–≤–µ—Ä–ª–µ–π */
    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 999;
      display: none;
    }
    
    /* 3.43 –ê–Ω–∏–º–∞—Ü–∏–∏ */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* 3.44 –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ */
    @media (max-width: 400px) {
      :root {
        --panel-width: 95%;
      }
      .forecast-container {
        padding: 10px;
      }
    }
      
    @media (max-width: 480px) {
      :root {
        --panel-width: 90%;
      }
      
      .share-buttons {
        flex-direction: row;
        gap: 8px;
      }
    }
    
    /* 3.45 –õ–æ–∞–¥–µ—Ä */
    .loader {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
      margin-left: 10px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* 3.46 –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
    .notification {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 12px 20px;
      border-radius: 8px;
      color: white;
      z-index: 1000;
      animation: slideIn 0.3s ease forwards;
    }
    
    .notification.success {
      background-color: var(--success-color);
    }
    
    .notification.error {
      background-color: var(--error-color);
    }
    
    .notification.fade-out {
      animation: fadeOut 0.3s ease forwards;
    }
    
    /* 3.47 –°—á–µ—Ç—á–∏–∫ –∑–≤–µ–∑–¥ */
    .stars-counter {
      position: fixed;
      top: 20px;
      left: 20px;
      background: var(--card-color);
      padding: 8px 15px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      gap: 8px;
      z-index: 50;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    
    .stars-counter i {
      color: gold;
    }
    
    /* 3.48 –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–≤–µ–∑–¥ */
    @keyframes starBounce {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.5); }
    }
    
    .star-added {
      animation: starBounce 0.5s ease;
    }
    
    /* 3.49 –°—Ç–∏–ª–∏ –¥–ª—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã */
    .ref-link {
      background: var(--card-color);
      padding: 10px;
      border-radius: 8px;
      margin-top: 15px;
      word-break: break-all;
      text-align: center;
      cursor: pointer;
    }
    
    .ref-link i {
      margin-right: 5px;
    }
    
    /* 3.50 –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö */
    .error-message {
      color: var(--error-color);
      font-size: 14px;
      margin-top: 5px;
      display: none;
    }
    
    input:invalid + .error-message,
    select:invalid + .error-message {
      display: block;
    }
    
    /* 3.51 –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –∫–Ω–æ–ø–æ–∫ */
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    .btn-pulse {
      animation: pulse 2s infinite;
    }
    
    /* 3.52 –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è UX */
    .tooltip {
      position: relative;
      display: inline-block;
    }
    
    .tooltip .tooltiptext {
      visibility: hidden;
      width: 200px;
      background-color: var(--card-color);
      color: var(--text-color);
      text-align: center;
      border-radius: 6px;
      padding: 5px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 14px;
    }
    
    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>
<body>
  <!-- 4. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∑–≤–µ–∑–¥–Ω–æ–≥–æ —Ñ–æ–Ω–∞ -->
  <div id="stars-container"></div>
  
  <!-- 5. –°—á–µ—Ç—á–∏–∫ –∑–≤–µ–∑–¥ -->
  <div class="stars-counter" id="starsCounter">
    <i class="fas fa-star"></i>
    <span id="starsCount">0</span>
  </div>
  
  <!-- 6. –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
  <div id="mainMenu">
    <div class="logo-container" id="themeToggle">
      <svg class="logo-svg" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <path id="star-path" d="M100,20 L123.5,70 L177.6,76.8 L137.8,113.9 L149.1,167.6 L100,142 L50.9,167.6 L62.2,113.9 L22.4,76.8 L76.5,70 Z" />
          <circle id="circle-path" cx="100" cy="100" r="80" />
        </defs>
        
        <text x="100" y="110" text-anchor="middle" font-size="24" fill="#9370db" font-weight="bold">AstroPred</text>
        
        <use href="#star-path" x="0" y="0" fill="none" stroke="#9370db" stroke-width="2">
          <animateTransform attributeName="transform" type="rotate" from="0 100 100" to="360 100 100" dur="20s" repeatCount="indefinite" />
        </use>
        
        <use href="#circle-path" fill="none" stroke="#6a5acd" stroke-width="2" stroke-dasharray="10,5">
          <animate attributeName="stroke-dashoffset" values="0;500;0" dur="15s" repeatCount="indefinite" />
        </use>
      </svg>
      <div class="logo-text">AstroPred</div>
      <span id="themeIcon" style="margin-top: 10px; font-size: 20px; display: block;">
        <i class="fas fa-moon"></i>
      </span>
    </div>
    
    <!-- 7. –û—Å–Ω–æ–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é -->
    <div class="main-menu">
      <button id="profileBtn" class="btn" aria-label="–ó–∞–ø–æ–ª–Ω–∏—Ç—å –∞–Ω–∫–µ—Ç—É">
        <i class="fas fa-user-edit"></i> –ê–Ω–∫–µ—Ç–∞
      </button>
      <button id="dailyForecastBtn" class="btn" aria-label="–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –¥–µ–Ω—å">
        <i class="fas fa-sun"></i> –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –¥–µ–Ω—å
      </button>
      <button id="weeklyForecastBtn" class="btn" aria-label="–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –Ω–µ–¥–µ–ª—é">
        <i class="fas fa-calendar-week"></i> –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –Ω–µ–¥–µ–ª—é
      </button>
      <button id="monthlyForecastBtn" class="btn" aria-label="–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –º–µ—Å—è—Ü">
        <i class="fas fa-calendar-alt"></i> –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –º–µ—Å—è—Ü
      </button>
    </div>
    
    <!-- 8. –û–≤–µ—Ä–ª–µ–π –¥–ª—è –±–æ–Ω—É—Å–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è -->
    <div class="overlay" id="overlay"></div>
    
    <!-- 9. –ë–æ–Ω—É—Å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ -->
    <div class="bonus-message" id="bonusMessage">
      <button class="close-bonus" id="closeBonusMessage" aria-label="–ó–∞–∫—Ä—ã—Ç—å">
        <i class="fas fa-times"></i>
      </button>
      <h3><i class="fas fa-gift"></i> –í–∞—à –º–∏–Ω–∏-–±–æ–Ω—É—Å!</h3>
      <p id="bonusText"></p>
      <div class="stars-added" id="starsAdded" style="display: none;">
        <i class="fas fa-star"></i> +<span id="starsAddedCount">1</span> –∑–≤–µ–∑–¥–∞
      </div>
    </div>
    
    <!-- 10. –ö–Ω–æ–ø–∫–∏ –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞ -->
    <div class="bottom-buttons">
      <button id="bonusBtn" class="btn btn-warning" aria-label="–ü–æ–ª—É—á–∏—Ç—å –±–æ–Ω—É—Å">
        <i class="fas fa-envelope"></i> –ü–æ–ª—É—á–∏—Ç—å –±–æ–Ω—É—Å
      </button>
      <button id="shareAppBtn" class="btn btn-info" aria-label="–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º">
        <i class="fas fa-share-alt"></i> –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
      </button>
    </div>
  </div>
  
  <!-- 11. –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å –¥–ª—è –∞–Ω–∫–µ—Ç—ã -->
  <div class="side-panel" id="profilePanel">
    <button class="close-panel" id="closeProfilePanel" aria-label="–ó–∞–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å">
      <i class="fas fa-times"></i>
    </button>
    
    <div style="display: flex; justify-content: space-between; align-items: center;">
      <h2><i class="fas fa-user-edit"></i> –ê–Ω–∫–µ—Ç–∞</h2>
      <button id="editProfileBtn" class="btn btn-info" style="display: none;">
        <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
      </button>
    </div>
    
    <!-- 12. –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –∞–Ω–∫–µ—Ç—ã -->
    <div id="formProgressContainer" class="progress-container">
      <div class="progress-bar" id="formProgressBar" style="width: 33%"></div>
      <div class="progress-steps">
        <div class="step active" id="step1">–õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</div>
        <div class="step" id="step2">–ê—Å—Ç—Ä–æ–ª–æ–≥–∏—è</div>
        <div class="step" id="step3">–ò–Ω—Ç–µ—Ä–µ—Å—ã</div>
      </div>
    </div>
    
    <!-- 13. –§–æ—Ä–º–∞ –∞–Ω–∫–µ—Ç—ã -->
    <form id="astroForm" style="display: none;">
      <div class="form-step" id="step1Form">
        <div class="form-group">
          <label for="name"><i class="fas fa-user"></i>–ò–º—è:</label>
          <input type="text" id="name" name="name" required aria-required="true" />
          <div class="error-message" id="name-error">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è</div>
        </div>
        
        <div class="form-group">
          <label for="gender"><i class="fas fa-venus-mars"></i>–ü–æ–ª:</label>
          <select id="gender" name="gender" required aria-required="true">
            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ</option>
            <option value="–º">–ú—É–∂—Å–∫–æ–π</option>
            <option value="–∂">–ñ–µ–Ω—Å–∫–∏–π</option>        
          </select>
          <div class="error-message" id="gender-error">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª</div>
        </div>
        
        <button type="button" class="btn next-step" id="nextStep1">
          –î–∞–ª–µ–µ <i class="fas fa-arrow-right"></i>
        </button>
      </div>
      
      <div class="form-step" id="step2Form" style="display: none;">
        <div class="form-group">
          <label for="birth_date"><i class="fas fa-calendar-day"></i>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</label>
          <input type="date" id="birth_date" name="birth_date" required aria-required="true" />
          <div class="error-message" id="birth_date-error">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –¥–∞—Ç—É</div>
        </div>
        
        <div class="form-group">
          <label for="birth_time"><i class="fas fa-clock"></i>–í—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</label>
          <input type="time" id="birth_time" name="birth_time" aria-describedby="timeHint" />
          <div class="field-hint" id="timeHint">–§–æ—Ä–º–∞—Ç: —á—á:–º–º (24-—á–∞—Å–æ–≤–æ–π)</div>
        </div>
        
        <div class="form-group">
          <label for="birth_city"><i class="fas fa-city"></i>–ì–æ—Ä–æ–¥ —Ä–æ–∂–¥–µ–Ω–∏—è:</label>
          <input type="text" id="birth_city" name="birth_city" required aria-required="true" />
          <div class="error-message" id="birth_city-error">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –≥–æ—Ä–æ–¥ —Ä–æ–∂–¥–µ–Ω–∏—è</div>
        </div>
        
        <div class="form-navigation">
          <button type="button" class="btn prev-step" id="prevStep2">
            <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
          </button>
          <button type="button" class="btn next-step" id="nextStep2">
            –î–∞–ª–µ–µ <i class="fas fa-arrow-right"></i>
          </button>
        </div>
      </div>
      
      <div class="form-step" id="step3Form" style="display: none;">
        <div class="form-group">
          <label for="interest"><i class="fas fa-star"></i>–û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä–µ—Å:</label>
          <select id="interest" name="interest" required aria-required="true">
            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ</option>
            <option value="–õ—é–±–æ–≤—å –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è">–õ—é–±–æ–≤—å –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è</option>
            <option value="–ö–∞—Ä—å–µ—Ä–∞ –∏ –±–∏–∑–Ω–µ—Å">–ö–∞—Ä—å–µ—Ä–∞ –∏ –±–∏–∑–Ω–µ—Å</option>
            <option value="–§–∏–Ω–∞–Ω—Å—ã –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏">–§–∏–Ω–∞–Ω—Å—ã –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏</option>
            <option value="–ó–¥–æ—Ä–æ–≤—å–µ –∏ –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏–µ">–ó–¥–æ—Ä–æ–≤—å–µ –∏ –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏–µ</option>
            <option value="–°–µ–º—å—è –∏ –¥–µ—Ç–∏">–°–µ–º—å—è –∏ –¥–µ—Ç–∏</option>
            <option value="–õ–∏—á–Ω–æ—Å—Ç–Ω—ã–π —Ä–æ—Å—Ç">–õ–∏—á–Ω–æ—Å—Ç–Ω—ã–π —Ä–æ—Å—Ç</option>
            <option value="–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ –∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ">–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ –∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ</option>
            <option value="–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –ø–µ—Ä–µ–µ–∑–¥—ã">–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –ø–µ—Ä–µ–µ–∑–¥—ã</option>
          </select>
          <div class="error-message" id="interest-error">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å</div>
        </div>
        
        <div class="form-group">
          <label for="relationship"><i class="fas fa-heart"></i>–°–µ–º–µ–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ:</label>
          <select id="relationship" name="relationship" required aria-required="true">
            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ</option>
            <option value="–í –ø–∞—Ä–µ">–í –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö</option>
            <option value="–ù–µ –≤ –ø–∞—Ä–µ">–ù–µ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö</option>
            <option value="–í –ø–æ–∏—Å–∫–µ">–í –ø–æ–∏—Å–∫–µ</option>
          </select>
          <div class="error-message" id="relationship-error">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ —Å–µ–º–µ–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ</div>
        </div>
        
        <div class="form-navigation">
          <button type="button" class="btn prev-step" id="prevStep3">
            <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
          </button>
          <button type="submit" class="btn btn-success" id="saveProfileBtn">
            <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∞–Ω–∫–µ—Ç—É
          </button>
        </div>
      </div>
    </form>
    
    <!-- 14. –ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ñ–∏–ª—è -->
    <div class="profile-view" id="profileView">
      <h3><i class="fas fa-user-circle"></i> –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ</h3>
      <div id="profileData"></div>
      
      <!-- 14.1 –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ -->
      <div class="ref-link" id="refLinkContainer" style="display: none;">
        <i class="fas fa-user-plus"></i> –ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∏—Ç–µ 5 –∑–≤–µ–∑–¥ –∑–∞ –∫–∞–∂–¥–æ–≥–æ!
        <div class="ref-link" id="refLink"></div>
      </div>
    </div>
  </div>
  
  <!-- 15. –ü–∞–Ω–µ–ª—å –ø—Ä–æ–≥–Ω–æ–∑–∞ -->
  <div class="side-panel" id="forecastPanel">
    <button class="close-panel" id="closeForecastPanel" aria-label="–ó–∞–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å">
      <i class="fas fa-times"></i>
    </button>
    <div class="forecast-container" id="forecastContainer">
      <div class="forecast-header">
        <h2 id="forecastTitle"><i class="fas fa-crystal-ball"></i> –í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∞—Å—Ç—Ä–æ–ø—Ä–æ–≥–Ω–æ–∑</h2>
        <p id="forecastDate"></p>
      </div>
      
      <div class="forecast-content" id="forecastContent">
      </div>
      
      <div class="share-buttons">
        <button class="btn telegram-btn" id="shareTelegram" aria-label="–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤ Telegram">
          <i class="fab fa-telegram"></i> Telegram
        </button>
        <button class="btn whatsapp-btn" id="shareWhatsApp" aria-label="–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤ WhatsApp">
          <i class="fab fa-whatsapp"></i> WhatsApp
        </button>
      </div>
    </div>
  </div>

  <!-- 16. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.js"></script>
  
  <!-- 17. –û—Å–Ω–æ–≤–Ω–æ–π JavaScript –∫–æ–¥ -->
  <script>
    // 17.1 –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è WebApp Telegram
    const tg = window.Telegram.WebApp;
    if (tg) {
      tg.expand();
      tg.enableClosingConfirmation();
    }
    
    // 17.2 –û—Å–Ω–æ–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
    const mainMenu = document.getElementById('mainMenu');
    const profileBtn = document.getElementById('profileBtn');
    const dailyForecastBtn = document.getElementById('dailyForecastBtn');
    const weeklyForecastBtn = document.getElementById('weeklyForecastBtn');
    const monthlyForecastBtn = document.getElementById('monthlyForecastBtn');
    const shareAppBtn = document.getElementById('shareAppBtn');
    const bonusBtn = document.getElementById('bonusBtn');
    const bonusMessage = document.getElementById('bonusMessage');
    const bonusText = document.getElementById('bonusText');
    const closeBonusMessage = document.getElementById('closeBonusMessage');
    const overlay = document.getElementById('overlay');
    const themeToggle = document.getElementById('themeToggle');
    const starsCounter = document.getElementById('starsCounter');
    const starsCount = document.getElementById('starsCount');
    const starsAdded = document.getElementById('starsAdded');
    const starsAddedCount = document.getElementById('starsAddedCount');
    const refLinkContainer = document.getElementById('refLinkContainer');
    const refLink = document.getElementById('refLink');
    
    // 17.3 –ü–∞–Ω–µ–ª–∏
    const profilePanel = document.getElementById('profilePanel');
    const forecastPanel = document.getElementById('forecastPanel');
    
    // 17.4 –ö–Ω–æ–ø–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–∞–Ω–µ–ª–µ–π
    const closeProfilePanel = document.getElementById('closeProfilePanel');
    const closeForecastPanel = document.getElementById('closeForecastPanel');
    
    // 17.5 –§–æ—Ä–º–∞ –∞–Ω–∫–µ—Ç—ã
    const profileForm = document.getElementById('astroForm');
    const saveProfileBtn = document.getElementById('saveProfileBtn');
    const profileView = document.getElementById('profileView');
    const profileData = document.getElementById('profileData');
    const editProfileBtn = document.getElementById('editProfileBtn');
    const formProgressContainer = document.getElementById('formProgressContainer');
    
    // 17.6 –ü—Ä–æ–≥–Ω–æ–∑
    const forecastContent = document.getElementById('forecastContent');
    const forecastDate = document.getElementById('forecastDate');
    const forecastTitle = document.getElementById('forecastTitle');
    
    // 17.7 –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –∞–Ω–∫–µ—Ç—ã
    const formProgressBar = document.getElementById('formProgressBar');
    const step1 = document.getElementById('step1');
    const step2 = document.getElementById('step2');
    const step3 = document.getElementById('step3');
    
    // 17.8 –®–∞–≥–∏ –∞–Ω–∫–µ—Ç—ã
    const step1Form = document.getElementById('step1Form');
    const step2Form = document.getElementById('step2Form');
    const step3Form = document.getElementById('step3Form');
    
    // 17.9 –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —à–∞–≥–∞–º
    const nextStep1 = document.getElementById('nextStep1');
    const nextStep2 = document.getElementById('nextStep2');
    const prevStep2 = document.getElementById('prevStep2');
    const prevStep3 = document.getElementById('prevStep3');
    
    // 17.10 –ú–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–µ —Ñ—Ä–∞–∑—ã –¥–ª—è –±–æ–Ω—É—Å–∞
    const bonusPhrases = [
      "–°–æ–ª–Ω—ã—à–∫–æ, —Å–µ–≥–æ–¥–Ω—è —Ç–≤–æ–π –¥–µ–Ω—å! –ó–≤–µ–∑–¥—ã —Å–ª–æ–∂–∏–ª–∏—Å—å –≤ —Ç–≤–æ—é –ø–æ–ª—å–∑—É ‚Äî –¥–µ–π—Å—Ç–≤—É–π —Å–º–µ–ª–æ!",
      "–†–æ–¥–Ω–æ–π —á–µ–ª–æ–≤–µ–∫, —Å–µ–≥–æ–¥–Ω—è –í—Å–µ–ª–µ–Ω–Ω–∞—è —à–µ–ø—á–µ—Ç: —Ç—ã —Å–∏–ª—å–Ω–µ–µ, —á–µ–º –¥—É–º–∞–µ—à—å! –í–µ—Ä—å –≤ —Å–µ–±—è!",
      "–õ—é–±–∏–º–æ–µ —Å–µ—Ä–¥—Ü–µ, —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å ‚Äî —Ç–≤–æ–π —à–∞–Ω—Å! –ù–µ —É–ø—É—Å—Ç–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–¥–µ–ª–∞—Ç—å —à–∞–≥ –∫ –º–µ—á—Ç–µ!",
      "–ë–ª–∏–∑–∫–∏–π –º–æ–π, –∑–≤–µ–∑–¥—ã –≥–æ–≤–æ—Ä—è—Ç ‚Äî —Å–µ–≥–æ–¥–Ω—è –¥–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —á—É–¥–µ—Å. –ë—É–¥—å –æ—Ç–∫—Ä—ã—Ç –∫ —Å—é—Ä–ø—Ä–∏–∑–∞–º!",
      "–¢–µ–ø–ª—ã–π —Å–≤–µ—Ç, —Ç–≤–æ—è —ç–Ω–µ—Ä–≥–∏—è —Å–µ–≥–æ–¥–Ω—è –Ω–∞ –≤—ã—Å–æ—Ç–µ! –ò—Å–ø–æ–ª—å–∑—É–π —ç—Ç–æ—Ç –¥–µ–Ω—å –¥–ª—è –≤–∞–∂–Ω—ã—Ö –¥–µ–ª!",
      "–°–æ–∫—Ä–æ–≤–∏—â–µ, —Å–µ–≥–æ–¥–Ω—è –∏–¥–µ–∞–ª—å–Ω—ã–π –º–æ–º–µ–Ω—Ç –¥–ª—è –Ω–æ–≤—ã—Ö –Ω–∞—á–∏–Ω–∞–Ω–∏–π. –î–µ—Ä–∑–∞–π!",
      "–†–∞–¥–æ—Å—Ç—å –º–æ—è, —Å–µ–≥–æ–¥–Ω—è —Ç–≤–æ—è –∏–Ω—Ç—É–∏—Ü–∏—è –æ—Å–æ–±–µ–Ω–Ω–æ —Å–∏–ª—å–Ω–∞. –î–æ–≤–µ—Ä—å—Å—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É –≥–æ–ª–æ—Å—É!",
      "–ê–Ω–≥–µ–ª–æ—á–µ–∫, –ø–æ–º–Ω–∏ ‚Äî –¥–∞–∂–µ –º–∞–ª–µ–Ω—å–∫–∏–µ —à–∞–≥–∏ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –±–æ–ª—å—à–∏–º —Ü–µ–ª—è–º. –¢—ã –º–æ–ª–æ–¥–µ—Ü!",
      "–ó–≤–µ–∑–¥–æ—á–∫–∞, —Å–µ–≥–æ–¥–Ω—è –¥–µ–Ω—å –º–∞–≥–∏–∏ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π. –í–µ—Ä—å –≤ —á—É–¥–µ—Å–∞ ‚Äî –æ–Ω–∏ —Ä—è–¥–æ–º!",
      "–°–æ–ª–Ω—ã—à–∫–æ, —Ç–≤–æ–∏ –º–µ—á—Ç—ã –±–ª–∏–∂–µ, —á–µ–º –∫–∞–∂–µ—Ç—Å—è. –ü—Ä–æ–¥–æ–ª–∂–∞–π –∏–¥—Ç–∏ ‚Äî —Ç—ã –Ω–∞ –≤–µ—Ä–Ω–æ–º –ø—É—Ç–∏!"
    ];
    
    // 17.11 –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±–æ–Ω—É—Å–∞
    const BONUS_COOLDOWN = 3 * 60 * 60 * 1000; // 3 —á–∞—Å–∞ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
    let lastBonusTime = parseInt(localStorage.getItem('lastBonusTime')) || 0;
    
    // 17.12 –°–æ–∑–¥–∞–Ω–∏–µ –∑–≤–µ–∑–¥–Ω–æ–≥–æ —Ñ–æ–Ω–∞
    function createStars() {
      const starsCount = 200;
      const containerWidth = window.innerWidth;
      const containerHeight = window.innerHeight;
      
      for (let i = 0; i < starsCount; i++) {
        const star = document.createElement('div');
        star.classList.add('star');
        
        const size = Math.random() * 3;
        const x = Math.random() * containerWidth;
        const y = Math.random() * containerHeight;
        const duration = 2 + Math.random() * 3 + 's';
        const delay = Math.random() * 5 + 's';
        
        star.style.width = `${size}px`;
        star.style.height = `${size}px`;
        star.style.left = `${x}px`;
        star.style.top = `${y}px`;
        star.style.setProperty('--duration', duration);
        star.style.animationDelay = delay;
        
        document.getElementById('stars-container').appendChild(star);
      }
    }
    
    // 17.13 –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞–∫–∞ –∑–æ–¥–∏–∞–∫–∞ –ø–æ –¥–∞—Ç–µ —Ä–æ–∂–¥–µ–Ω–∏—è
    function getZodiacSign(dateString) {
      if (!dateString) return '';
      
      const date = new Date(dateString);
      const day = date.getDate();
      const month = date.getMonth() + 1;
      
      if ((month == 3 && day >= 21) || (month == 4 && day <= 19)) return '–û–≤–µ–Ω';
      if ((month == 4 && day >= 20) || (month == 5 && day <= 20)) return '–¢–µ–ª–µ—Ü';
      if ((month == 5 && day >= 21) || (month == 6 && day <= 20)) return '–ë–ª–∏–∑–Ω–µ—Ü—ã';
      if ((month == 6 && day >= 21) || (month == 7 && day <= 22)) return '–†–∞–∫';
      if ((month == 7 && day >= 23) || (month == 8 && day <= 22)) return '–õ–µ–≤';
      if ((month == 8 && day >= 23) || (month == 9 && day <= 22)) return '–î–µ–≤–∞';
      if ((month == 9 && day >= 23) || (month == 10 && day <= 22)) return '–í–µ—Å—ã';
      if ((month == 10 && day >= 23) || (month == 11 && day <= 21)) return '–°–∫–æ—Ä–ø–∏–æ–Ω';
      if ((month == 11 && day >= 22) || (month == 12 && day <= 21)) return '–°—Ç—Ä–µ–ª–µ—Ü';
      if ((month == 12 && day >= 22) || (month == 1 && day <= 19)) return '–ö–æ–∑–µ—Ä–æ–≥';
      if ((month == 1 && day >= 20) || (month == 2 && day <= 18)) return '–í–æ–¥–æ–ª–µ–π';
      if ((month == 2 && day >= 19) || (month == 3 && day <= 20)) return '–†—ã–±—ã';
      
      return '';
    }
    
    // 17.14 –ü–æ–ª—É—á–µ–Ω–∏–µ –≥–æ—Ä–æ—Å–∫–æ–ø–∞ —á–µ—Ä–µ–∑ OpenRouter API
    async function getHoroscope(zodiacSign, period = 'today') {
      try {
        // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ä—É—Å—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–Ω–∞–∫–∞ –≤ –∞–Ω–≥–ª–∏–π—Å–∫–æ–µ –¥–ª—è API
        const zodiacMap = {
          '–û–≤–µ–Ω': 'Aries',
          '–¢–µ–ª–µ—Ü': 'Taurus',
          '–ë–ª–∏–∑–Ω–µ—Ü—ã': 'Gemini',
          '–†–∞–∫': 'Cancer',
          '–õ–µ–≤': 'Leo',
          '–î–µ–≤–∞': 'Virgo',
          '–í–µ—Å—ã': 'Libra',
          '–°–∫–æ—Ä–ø–∏–æ–Ω': 'Scorpio',
          '–°—Ç—Ä–µ–ª–µ—Ü': 'Sagittarius',
          '–ö–æ–∑–µ—Ä–æ–≥': 'Capricorn',
          '–í–æ–¥–æ–ª–µ–π': 'Aquarius',
          '–†—ã–±—ã': 'Pisces'
        };
        
        const sign = zodiacMap[zodiacSign] || 'Aries';
        const periodMap = {
          'today': 'today',
          'day': 'today',
          'week': 'week',
          'month': 'month'
        };
        
        const periodKey = periodMap[period] || 'today';
        
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º OpenRouter API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ–≥–Ω–æ–∑–∞
        const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
          method: 'POST',
          headers: {
            'Authorization': 'Bearer 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',
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            model: "openai/gpt-3.5-turbo",
            messages: [
              {
                role: "user",
                content: `–ù–∞–ø–∏—à–∏ –∞—Å—Ç—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–≥–Ω–æ–∑ –¥–ª—è –∑–Ω–∞–∫–∞ ${zodiacSign} –Ω–∞ ${periodKey === 'today' ? '—Å–µ–≥–æ–¥–Ω—è' : periodKey === 'week' ? '–Ω–µ–¥–µ–ª—é' : '–º–µ—Å—è—Ü'}. 
                –ë—É–¥—å –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–º –∏ –º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–º, –∏—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏. –û—Ç–≤–µ—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.`
              }
            ]
          })
        });

        if (!response.ok) {
          throw new Error('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API');
        }

        const data = await response.json();
        const forecast = data.choices?.[0]?.message?.content || '–û–ø–∏—Å–∞–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ';
        
        return {
          description: forecast,
          date: new Date().toLocaleDateString('ru-RU')
        };
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞:', error);
        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–≥–Ω–æ–∑—ã, –µ—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ
        return getLocalHoroscope(zodiacSign, period);
      }
    }

    // 17.15 –õ–æ–∫–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≥–Ω–æ–∑—ã (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è, –µ—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ)
    function getLocalHoroscope(zodiacSign, period) {
      const forecasts = {
        '–û–≤–µ–Ω': {
          today: "üî• –°–µ–≥–æ–¥–Ω—è –∑–≤–µ–∑–¥—ã –±–ª–∞–≥–æ–≤–æ–ª—è—Ç –û–≤–Ω–∞–º! –≠—Ç–æ –æ—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å –¥–ª—è –Ω–æ–≤—ã—Ö –Ω–∞—á–∏–Ω–∞–Ω–∏–π –∏ —Å–º–µ–ª—ã—Ö —Ä–µ—à–µ–Ω–∏–π. –í–∞—à–∞ —ç–Ω–µ—Ä–≥–∏—è –Ω–∞ –≤—ã—Å–æ—Ç–µ - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ!",
          week: "üöÄ –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –û–≤–Ω–∞–º —Å—Ç–æ–∏—Ç –ø—Ä–æ—è–≤–∏—Ç—å –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É. –í–æ–∑–º–æ–∂–Ω—ã –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –ø–æ–≤–æ—Ä–æ—Ç—ã —Å–æ–±—ã—Ç–∏–π, –Ω–æ –æ–Ω–∏ –ø—Ä–∏–≤–µ–¥—É—Ç –∫ —Ö–æ—Ä–æ—à–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º.",
          month: "üåà –≠—Ç–æ—Ç –º–µ—Å—è—Ü –ø—Ä–∏–Ω–µ—Å–µ—Ç –û–≤–Ω–∞–º –≤–∞–∂–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è. –ë—É–¥—å—Ç–µ –≥–æ—Ç–æ–≤—ã –∫ –Ω–æ–≤—ã–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º –∏ –Ω–µ –±–æ–π—Ç–µ—Å—å –≤—ã—Ö–æ–¥–∏—Ç—å –∏–∑ –∑–æ–Ω—ã –∫–æ–º—Ñ–æ—Ä—Ç–∞!"
        },
        '–¢–µ–ª–µ—Ü': {
          today: "üíé –°–µ–≥–æ–¥–Ω—è –¢–µ–ª—å—Ü–∞–º —Å—Ç–æ–∏—Ç –ø—Ä–æ—è–≤–∏—Ç—å —Ç–µ—Ä–ø–µ–Ω–∏–µ. –ò–∑–±–µ–≥–∞–π—Ç–µ –ø–æ—Å–ø–µ—à–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π - –ª—É—á—à–µ–µ –ø—Ä–∏–¥–µ—Ç –∫ –≤–∞–º —Å–∞–º–æ.",
          week: "üí∞ –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –¢–µ–ª—å—Ü—ã –º–æ–≥—É—Ç —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å. –•–æ—Ä–æ—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –±—é–¥–∂–µ—Ç–∞.",
          month: "üå± –≠—Ç–æ—Ç –º–µ—Å—è—Ü –±—É–¥–µ—Ç –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã–º –¥–ª—è –¢–µ–ª—å—Ü–æ–≤. –°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Ç–µ—Å—å –Ω–∞ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Ü–µ–ª—è—Ö - –≤–∞—à–∏ —É—Å–∏–ª–∏—è –æ–∫—É–ø—è—Ç—Å—è!"
        },
        '–ë–ª–∏–∑–Ω–µ—Ü—ã': {
          today: "üí° –°–µ–≥–æ–¥–Ω—è –ë–ª–∏–∑–Ω–µ—Ü–∞–º —Å—Ç–æ–∏—Ç –ø—Ä–∏—Å–ª—É—à–∞—Ç—å—Å—è –∫ —Å–≤–æ–µ–π –∏–Ω—Ç—É–∏—Ü–∏–∏. –ù–æ–≤—ã–µ –∏–¥–µ–∏ –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º.",
          week: "üìö –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –ë–ª–∏–∑–Ω–µ—Ü–∞–º –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω–æ —É—á–∏—Ç—å—Å—è —á–µ–º—É-—Ç–æ –Ω–æ–≤–æ–º—É. –ó–Ω–∞–Ω–∏—è, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Å–µ–π—á–∞—Å, –ø—Ä–∏–≥–æ–¥—è—Ç—Å—è –≤ –±—É–¥—É—â–µ–º.",
          month: "üó£ –≠—Ç–æ—Ç –º–µ—Å—è—Ü —Ö–æ—Ä–æ—à –¥–ª—è –æ–±—â–µ–Ω–∏—è. –ë–ª–∏–∑–Ω–µ—Ü—ã —Å–º–æ–≥—É—Ç –Ω–∞–ª–∞–¥–∏—Ç—å –ø–æ–ª–µ–∑–Ω—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã –∏ —É–∫—Ä–µ–ø–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–≤—è–∑–∏."
        },
        '–†–∞–∫': {
          today: "üè° –°–µ–≥–æ–¥–Ω—è –†–∞–∫–∞–º —Å—Ç–æ–∏—Ç —É–¥–µ–ª–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –¥–æ–º—É –∏ —Å–µ–º—å–µ. –ú–∞–ª–µ–Ω—å–∫–∏–µ —Ä–∞–¥–æ—Å—Ç–∏ –ø—Ä–∏–Ω–µ—Å—É—Ç –±–æ–ª—å—à–æ–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–∏–µ.",
          week: "üíñ –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –†–∞–∫–∏ –±—É–¥—É—Ç –æ—Å–æ–±–µ–Ω–Ω–æ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –∫ —ç–º–æ—Ü–∏—è–º –æ–∫—Ä—É–∂–∞—é—â–∏—Ö. –ü—Ä–æ—è–≤–∏—Ç–µ –∑–∞–±–æ—Ç—É –æ –±–ª–∏–∑–∫–∏—Ö.",
          month: "üåä –≠—Ç–æ—Ç –º–µ—Å—è—Ü –ø—Ä–∏–Ω–µ—Å–µ—Ç –†–∞–∫–∞–º —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å. –•–æ—Ä–æ—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –Ω–∞–∫–æ–ø–∏–≤—à–∏—Ö—Å—è –≤–æ–ø—Ä–æ—Å–æ–≤."
        },
        '–õ–µ–≤': {
          today: "üëë –°–µ–≥–æ–¥–Ω—è –õ—å–≤—ã –±—É–¥—É—Ç –≤ —Ü–µ–Ω—Ç—Ä–µ –≤–Ω–∏–º–∞–Ω–∏—è! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç –¥–µ–Ω—å –¥–ª—è –≤–∞–∂–Ω—ã—Ö –≤—Å—Ç—Ä–µ—á –∏ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π.",
          week: "‚ú® –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –õ—å–≤—ã –ø–æ—á—É–≤—Å—Ç–≤—É—é—Ç –ø—Ä–∏–ª–∏–≤ —Ç–≤–æ—Ä—á–µ—Å–∫–æ–π —ç–Ω–µ—Ä–≥–∏–∏. –•–æ—Ä–æ—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–º–±–∏—Ü–∏–æ–∑–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤.",
          month: "üåü –≠—Ç–æ—Ç –º–µ—Å—è—Ü –ø—Ä–∏–Ω–µ—Å–µ—Ç –õ—å–≤–∞–º –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ –∏—Ö –∑–∞—Å–ª—É–≥. –í–∞—à–∏ —Ç–∞–ª–∞–Ω—Ç—ã –±—É–¥—É—Ç –∑–∞–º–µ—á–µ–Ω—ã –∏ –æ—Ü–µ–Ω–µ–Ω—ã –ø–æ –¥–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤—É."
        },
        '–î–µ–≤–∞': {
          today: "üìù –°–µ–≥–æ–¥–Ω—è –î–µ–≤–∞–º —Å—Ç–æ–∏—Ç –∑–∞–Ω—è—Ç—å—Å—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º. –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ–º–æ–∂–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ –≤ –±—É–¥—É—â–µ–º.",
          week: "üîç –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –î–µ–≤–∞–º –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ —Ç–µ–∫—É—â–∏—Ö –¥–µ–ª–∞—Ö. –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è - –≤–∞—à –∫–ª—é—á –∫ —É—Å–ø–µ—Ö—É.",
          month: "üåø –≠—Ç–æ—Ç –º–µ—Å—è—Ü —Ö–æ—Ä–æ—à –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è –∏ –ø—Ä–∏–≤—ã—á–µ–∫. –ú–∞–ª–µ–Ω—å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–≤–µ–¥—É—Ç –∫ –±–æ–ª—å—à–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º."
        },
        '–í–µ—Å—ã': {
          today: "‚öñÔ∏è –°–µ–≥–æ–¥–Ω—è –í–µ—Å–∞–º –≤–∞–∂–Ω–æ –Ω–∞–π—Ç–∏ –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ä–∞–±–æ—Ç–æ–π –∏ –æ—Ç–¥—ã—Ö–æ–º. –ù–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–π—Ç–µ —Å–µ–±—è.",
          week: "üíë –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –í–µ—Å—ã —Å–º–æ–≥—É—Ç —É–∫—Ä–µ–ø–∏—Ç—å –ª–∏—á–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è. –•–æ—Ä–æ—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è —Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏—Ö –∂–µ—Å—Ç–æ–≤.",
          month: "üé® –≠—Ç–æ—Ç –º–µ—Å—è—Ü –ø—Ä–∏–Ω–µ—Å–µ—Ç –í–µ—Å–∞–º –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ. –¢–≤–æ—Ä—á–µ—Å–∫–∏–µ –ø—Ä–æ–µ–∫—Ç—ã –±—É–¥—É—Ç –æ—Å–æ–±–µ–Ω–Ω–æ —É—Å–ø–µ—à–Ω—ã–º–∏."
        },
        '–°–∫–æ—Ä–ø–∏–æ–Ω': {
          today: "ü¶Ç –°–µ–≥–æ–¥–Ω—è –°–∫–æ—Ä–ø–∏–æ–Ω–∞–º —Å—Ç–æ–∏—Ç –¥–æ–≤–µ—Ä–∏—Ç—å—Å—è —Å–≤–æ–µ–π –∏–Ω—Ç—É–∏—Ü–∏–∏. –û–Ω–∞ –ø–æ–¥—Å–∫–∞–∂–µ—Ç –≤–µ—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.",
          week: "üí™ –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –°–∫–æ—Ä–ø–∏–æ–Ω—ã –ø–æ—á—É–≤—Å—Ç–≤—É—é—Ç –ø—Ä–∏–ª–∏–≤ —Å–∏–ª. –•–æ—Ä–æ—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è —Ä–µ—à–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á.",
          month: "üîÑ –≠—Ç–æ—Ç –º–µ—Å—è—Ü –ø—Ä–∏–Ω–µ—Å–µ—Ç –°–∫–æ—Ä–ø–∏–æ–Ω–∞–º –≤–∞–∂–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω—ã. –ë—É–¥—å—Ç–µ –≥–æ—Ç–æ–≤—ã –∫ –Ω–æ–≤–æ–º—É —ç—Ç–∞–ø—É –≤ –∂–∏–∑–Ω–∏."
        },
        '–°—Ç—Ä–µ–ª–µ—Ü': {
          today: "üèπ –°–µ–≥–æ–¥–Ω—è –°—Ç—Ä–µ–ª—å—Ü—ã –±—É–¥—É—Ç –ø–æ–ª–Ω—ã —ç–Ω–µ—Ä–≥–∏–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç –¥–µ–Ω—å –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π.",
          week: "üåç –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –°—Ç—Ä–µ–ª—å—Ü—ã –º–æ–≥—É—Ç –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è–º–∏ –∏–ª–∏ –æ–±—É—á–µ–Ω–∏–µ–º.",
          month: "üéØ –≠—Ç–æ—Ç –º–µ—Å—è—Ü —Ö–æ—Ä–æ—à –¥–ª—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–æ–≤—ã—Ö —Ü–µ–ª–µ–π. –í–∞—à –æ–ø—Ç–∏–º–∏–∑–º –ø–æ–º–æ–∂–µ—Ç –¥–æ—Å—Ç–∏—á—å –∂–µ–ª–∞–µ–º–æ–≥–æ."
        },
        '–ö–æ–∑–µ—Ä–æ–≥': {
          today: "üèî –°–µ–≥–æ–¥–Ω—è –ö–æ–∑–µ—Ä–æ–≥–∞–º —Å—Ç–æ–∏—Ç —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ –∫–∞—Ä—å–µ—Ä–µ. –í–∞—à–∏ —É—Å–∏–ª–∏—è –±—É–¥—É—Ç –∑–∞–º–µ—á–µ–Ω—ã —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ–º.",
          week: "üìà –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –ö–æ–∑–µ—Ä–æ–≥–∏ —Å–º–æ–≥—É—Ç –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—å—Å—è –ø–æ –∫–∞—Ä—å–µ—Ä–Ω–æ–π –ª–µ—Å—Ç–Ω–∏—Ü–µ. –ü—Ä–æ—è–≤–∏—Ç–µ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É.",
          month: "üíº –≠—Ç–æ—Ç –º–µ—Å—è—Ü –ø—Ä–∏–Ω–µ—Å–µ—Ç –ö–æ–∑–µ—Ä–æ–≥–∞–º —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å. –•–æ—Ä–æ—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π."
        },
        '–í–æ–¥–æ–ª–µ–π': {
          today: "üí° –°–µ–≥–æ–¥–Ω—è –í–æ–¥–æ–ª–µ–∏ –±—É–¥—É—Ç –ø–æ–ª–Ω—ã –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –∏–¥–µ–π. –î–µ–ª–∏—Ç–µ—Å—å –∏–º–∏ —Å –æ–∫—Ä—É–∂–∞—é—â–∏–º–∏!",
          week: "üë• –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –í–æ–¥–æ–ª–µ–∏ —Å–º–æ–≥—É—Ç –Ω–∞–π—Ç–∏ –µ–¥–∏–Ω–æ–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–≤. –ö–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø—Ä–∏–Ω–µ—Å–µ—Ç —É—Å–ø–µ—Ö.",
          month: "üöÄ –≠—Ç–æ—Ç –º–µ—Å—è—Ü –ø—Ä–∏–Ω–µ—Å–µ—Ç –í–æ–¥–æ–ª–µ—è–º –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏. –ë—É–¥—å—Ç–µ –æ—Ç–∫—Ä—ã—Ç—ã –¥–ª—è –Ω–æ–≤–æ–≥–æ."
        },
        '–†—ã–±—ã': {
          today: "üåä –°–µ–≥–æ–¥–Ω—è –†—ã–±–∞–º —Å—Ç–æ–∏—Ç –ø—Ä–∏—Å–ª—É—à–∞—Ç—å—Å—è –∫ —Å–≤–æ–∏–º —á—É–≤—Å—Ç–≤–∞–º. –¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ –ø—Ä–∏–Ω–µ—Å–µ—Ç —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–∏–µ.",
          week: "üí≠ –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –†—ã–±—ã –±—É–¥—É—Ç –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–æ–Ω–∏—Ü–∞—Ç–µ–ª—å–Ω—ã. –î–æ–≤–µ—Ä—è–π—Ç–µ —Å–≤–æ–∏–º –ø—Ä–µ–¥—á—É–≤—Å—Ç–≤–∏—è–º.",
          month: "üåô –≠—Ç–æ—Ç –º–µ—Å—è—Ü —Ö–æ—Ä–æ—à –¥–ª—è –¥—É—Ö–æ–≤–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞ –∏ —Å–∞–º–æ–ø–æ–∑–Ω–∞–Ω–∏—è. –ù–∞–π–¥–∏—Ç–µ –≤—Ä–µ–º—è –¥–ª—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π."
        }
      };

      const periodMap = {
        'today': 'today',
        'day': 'today',
        'week': 'week',
        'month': 'month'
      };

      const periodKey = periodMap[period] || 'today';
      const defaultForecast = "‚ú® –°–µ–≥–æ–¥–Ω—è –±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã–π –¥–µ–Ω—å. –ü—Ä–∏—Å–ª—É—à–∏–≤–∞–π—Ç–µ—Å—å –∫ —Å–≤–æ–µ–π –∏–Ω—Ç—É–∏—Ü–∏–∏ –∏ –≤–µ—Ä—å—Ç–µ –≤ –ª—É—á—à–µ–µ!";

      return {
        description: forecasts[zodiacSign]?.[periodKey] || defaultForecast,
        date: new Date().toLocaleDateString('ru-RU')
      };
    }

    // 17.16 –ü–æ–∫–∞–∑–∞—Ç—å –±–æ–∫–æ–≤—É—é –ø–∞–Ω–µ–ª—å
    function showPanel(panel) {
      document.querySelectorAll('.side-panel').forEach(p => {
        p.classList.remove('active');
      });
      panel.classList.add('active');
      document.body.classList.add('panel-open');
      
      // –ù–∞—á–∏—Å–ª—è–µ–º –∑–≤–µ–∑–¥—ã –∑–∞ –ø–æ—Å–µ—â–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞
      if (panel === profilePanel) {
        addStars(1, '–ü–æ—Å–µ—â–µ–Ω–∏–µ –∞–Ω–∫–µ—Ç—ã');
      } else if (panel === forecastPanel) {
        addStars(2, '–ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ–≥–Ω–æ–∑–∞');
      }
    }
    
    // 17.17 –°–∫—Ä—ã—Ç—å –≤—Å–µ –±–æ–∫–æ–≤—ã–µ –ø–∞–Ω–µ–ª–∏
    function hideAllPanels() {
      document.querySelectorAll('.side-panel').forEach(panel => {
        panel.classList.remove('active');
      });
      document.body.classList.remove('panel-open');
    }
    
    // 17.18 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞ –∞–Ω–∫–µ—Ç—ã
    function updateProgress(currentStep) {
      const progress = (currentStep / 3) * 100;
      formProgressBar.style.width = `${progress}%`;
      
      step1.classList.remove('active', 'completed');
      step2.classList.remove('active', 'completed');
      step3.classList.remove('active', 'completed');
      
      if (currentStep >= 1) step1.classList.add('completed');
      if (currentStep >= 2) step2.classList.add('completed');
      if (currentStep >= 3) step3.classList.add('completed');
      
      document.getElementById(`step${currentStep}`).classList.add('active');
    }
    
    // 17.19 –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É –∞–Ω–∫–µ—Ç—ã
    function goToNextStep(currentStep, nextStep) {
      const currentForm = document.getElementById(`step${currentStep}Form`);
      const inputs = currentForm.querySelectorAll('input, select');

      for (let field of inputs) {
        if (!field.checkValidity()) {
          field.reportValidity();
          return;
        }
      }

      currentForm.style.display = 'none';
      document.getElementById(`step${nextStep}Form`).style.display = 'block';
      updateProgress(nextStep);
      profilePanel.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // 17.20 –ü–µ—Ä–µ—Ö–æ–¥ –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —à–∞–≥—É –∞–Ω–∫–µ—Ç—ã
    function goToPrevStep(currentStep, prevStep) {
      document.getElementById(`step${currentStep}Form`).style.display = 'none';
      document.getElementById(`step${prevStep}Form`).style.display = 'block';
      updateProgress(prevStep);
      profilePanel.scrollTo({ top: 0, behavior: 'smooth' });
    }
    
    // 17.21 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–≥–Ω–æ–∑–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö
    async function generateForecast(data, period = '–¥–µ–Ω—å') {
      const zodiac = getZodiacSign(data.birth_date);
      
      if (!zodiac) {
        return '<p>–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∑–Ω–∞–∫ –∑–æ–¥–∏–∞–∫–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è.</p>';
      }
      
      // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–µ—Ä–∏–æ–¥ –¥–ª—è API
      let apiPeriod = 'today';
      if (period === '–Ω–µ–¥–µ–ª—é') apiPeriod = 'week';
      if (period === '–º–µ—Å—è—Ü') apiPeriod = 'month';
      
      // –ü–æ–ª—É—á–∞–µ–º –≥–æ—Ä–æ—Å–∫–æ–ø –∏–∑ API
      const horoscope = await getHoroscope(zodiac, apiPeriod);
      
      if (!horoscope) {
        return '<p>–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.</p>';
      }
      
      // –§–æ—Ä–º–∏—Ä—É–µ–º HTML –ø—Ä–æ–≥–Ω–æ–∑–∞
      let forecastHTML = `
        <div class="forecast-section">
          <h3><i class="fas fa-user-astronaut"></i> –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
          <p>–ò–º—è: ${data.name}</p>
          <p>–ó–Ω–∞–∫ –∑–æ–¥–∏–∞–∫–∞: ${zodiac}</p>
          <p>–ò–Ω—Ç–µ—Ä–µ—Å: ${data.interest}</p>
        </div>
        
        <div class="forecast-section">
          <h3><i class="fas fa-star"></i> –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–≥–Ω–æ–∑</h3>
          <p>${horoscope.description}</p>
      `;
      
      if (period === '–¥–µ–Ω—å') {
        forecastHTML += `
          <p><strong>–î–∞—Ç–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞:</strong> ${horoscope.date}</p>
        `;
      }
      
      forecastHTML += `</div>`;
      
      // –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
      forecastHTML += `
        <div class="forecast-section">
          <h3><i class="fas fa-lightbulb"></i> –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h3>
          <p>${getPersonalAdvice(data, horoscope, period)}</p>
        </div>
      `;
      
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–æ–≥–Ω–æ–∑–∞
      forecastTitle.innerHTML = `<i class="fas fa-crystal-ball"></i> –í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∞—Å—Ç—Ä–æ–ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ ${period}`;
      
      return forecastHTML;
    }
    
    // 17.22 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
    function getPersonalAdvice(data, horoscope, period) {
      let advice = '';
      
      if (data.interest === '–õ—é–±–æ–≤—å –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è') {
        if (data.relationship === '–í –ø–∞—Ä–µ') {
          advice = `üíë –í —ç—Ç–æ—Ç ${period} –∑–≤–µ–∑–¥—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç —É–¥–µ–ª–∏—Ç—å –±–æ–ª—å—à–µ –≤–Ω–∏–º–∞–Ω–∏—è –ø–∞—Ä—Ç–Ω–µ—Ä—É. –•–æ—Ä–æ—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è –≤–∞—à–∏—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π.`;
        } else {
          advice = `üíï –≠—Ç–æ—Ç ${period} –±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–µ–Ω –¥–ª—è –Ω–æ–≤—ã—Ö –∑–Ω–∞–∫–æ–º—Å—Ç–≤. –ë—É–¥—å—Ç–µ –æ—Ç–∫—Ä—ã—Ç—ã –¥–ª—è –Ω–æ–≤—ã—Ö –≤—Å—Ç—Ä–µ—á.`;
        }
      } 
      else if (data.interest === '–ö–∞—Ä—å–µ—Ä–∞ –∏ –±–∏–∑–Ω–µ—Å') {
        advice = `üíº –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ñ–µ—Ä–∞: ${horoscope.description.split('.')[0]}. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç ${period} –¥–ª—è –≤–∞–∂–Ω—ã—Ö –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤.`;
      }
      else if (data.interest === '–§–∏–Ω–∞–Ω—Å—ã –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏') {
        advice = `üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è —É–¥–∞—á–∞ —Å–µ–≥–æ–¥–Ω—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–∞—à–∏—Ö —Ä–µ—à–µ–Ω–∏–π. ${horoscope.description.split('.')[0] || '–ó–≤–µ–∑–¥—ã —Å–æ–≤–µ—Ç—É—é—Ç –±—ã—Ç—å –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–µ–µ.'}`;
      }
      else if (data.interest === '–ó–¥–æ—Ä–æ–≤—å–µ –∏ –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏–µ') {
        advice = `üåø –≠—Ç–æ—Ç ${period} - —Ö–æ—Ä–æ—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è –∑–∞–±–æ—Ç—ã –æ –∑–¥–æ—Ä–æ–≤—å–µ. ${horoscope.description.split('.')[0] || '–ü—Ä–∏—Å–ª—É—à–∞–π—Ç–µ—Å—å –∫ —Å–≤–æ–µ–º—É —Ç–µ–ª—É.'}`;
      }
      else {
        advice = `‚ú® –î–ª—è –≤–∞—Å –≤ —ç—Ç–æ—Ç ${period}: ${horoscope.description.split('.')[0]}. –°–ª–µ–¥—É–π—Ç–µ —Å–≤–æ–µ–π –∏–Ω—Ç—É–∏—Ü–∏–∏.`;
      }
      
      return advice;
    }
    
    // 17.23 –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    function showNotification(message, type = 'success') {
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.textContent = message;
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.classList.add('fade-out');
        setTimeout(() => {
          notification.remove();
        }, 300);
      }, 3000);
    }
    
    // 17.24 –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è
    function displayProfileData(data) {
      if (!data || !data.name) {
        profileData.innerHTML = '<p>–ê–Ω–∫–µ—Ç–∞ –µ—â–µ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞.</p>';
        refLinkContainer.style.display = 'none';
        return;
      }
      
      const zodiac = getZodiacSign(data.birth_date);
      
      profileData.innerHTML = `
        <p><strong>–ò–º—è:</strong> ${data.name}</p>
        <p><strong>–ü–æ–ª:</strong> ${data.gender === '–º' ? '–ú—É–∂—Å–∫–æ–π' : '–ñ–µ–Ω—Å–∫–∏–π'}</p>
        <p><strong>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</strong> ${new Date(data.birth_date).toLocaleDateString('ru-RU')}</p>
        ${data.birth_time ? `<p><strong>–í—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è:</strong> ${data.birth_time}</p>` : ''}
        <p><strong>–ì–æ—Ä–æ–¥ —Ä–æ–∂–¥–µ–Ω–∏—è:</strong> ${data.birth_city}</p>
        <p><strong>–ó–Ω–∞–∫ –∑–æ–¥–∏–∞–∫–∞:</strong> ${zodiac || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'}</p>
        <p><strong>–û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä–µ—Å:</strong> ${data.interest}</p>
        <p><strong>–°–µ–º–µ–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ:</strong> ${data.relationship}</p>
      `;
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É
      refLinkContainer.style.display = 'block';
      generateRefLink(data.name);
    }
    
    // 17.25 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏
    function generateRefLink(name) {
      const refCode = `ref_${name.toLowerCase().replace(/\s+/g, '')}_${Math.floor(1000 + Math.random() * 9000)}`;
      localStorage.setItem('refCode', refCode);
      
      const refUrl = `https://t.me/astropred_bot?start=${refCode}`;
      refLink.innerHTML = `<i class="fas fa-link"></i> ${refUrl}`;
      
      // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Å—ã–ª–∫–∏
      refLink.onclick = () => {
        navigator.clipboard.writeText(refUrl)
          .then(() => showNotification('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!', 'success'))
          .catch(() => showNotification('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É', 'error'));
      };
    }
    
    // 17.26 –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞–Ω–∫–µ—Ç—ã
    function toggleProfileViewMode(editMode = false) {
      if (editMode) {
        // –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        profileView.style.display = 'none';
        profileForm.style.display = 'block';
        formProgressContainer.style.display = 'block';
        editProfileBtn.style.display = 'none';
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–π —à–∞–≥ —Ñ–æ—Ä–º—ã
        step1Form.style.display = 'block';
        step2Form.style.display = 'none';
        step3Form.style.display = 'none';
        updateProgress(1);
      } else {
        // –†–µ–∂–∏–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
        profileView.style.display = 'block';
        profileForm.style.display = 'none';
        formProgressContainer.style.display = 'none';
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –µ—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ
        const savedData = localStorage.getItem('astroProfileData');
        editProfileBtn.style.display = savedData ? 'block' : 'none';
      }
    }
    
    // 17.27 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–≤–µ–∑–¥ –Ω–∞ —Å—á–µ—Ç
    function addStars(count, reason = '') {
      let currentStars = parseInt(localStorage.getItem('starsCount')) || 0;
      currentStars += count;
      localStorage.setItem('starsCount', currentStars);
      starsCount.textContent = currentStars;
      
      // –ê–Ω–∏–º–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–≤–µ–∑–¥
      starsCounter.classList.add('star-added');
      setTimeout(() => {
        starsCounter.classList.remove('star-added');
      }, 500);
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–∏
      if (reason) {
        showNotification(`+${count} –∑–≤–µ–∑–¥ –∑–∞ ${reason}`, 'success');
      }
      
      return currentStars;
    }
    
    // 17.28 –ü–æ–∫–∞–∑–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π –±–æ–Ω—É—Å
    function showRandomBonus() {
      const now = Date.now();
      const timeLeft = lastBonusTime + BONUS_COOLDOWN - now;
      
      if (timeLeft > 0) {
        const hoursLeft = Math.ceil(timeLeft / (60 * 60 * 1000));
        showNotification(`–í—ã —Å–º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–π –±–æ–Ω—É—Å —á–µ—Ä–µ–∑ ${hoursLeft} —á–∞—Å–∞(–æ–≤)`, 'error');
        return;
      }
      
      const randomIndex = Math.floor(Math.random() * bonusPhrases.length);
      bonusText.textContent = bonusPhrases[randomIndex];
      
      // –ù–∞—á–∏—Å–ª—è–µ–º –∑–≤–µ–∑–¥—ã –∑–∞ –±–æ–Ω—É—Å
      const starsToAdd = 1 + Math.floor(Math.random() * 3); // 1-3 –∑–≤–µ–∑–¥—ã
      starsAddedCount.textContent = starsToAdd;
      starsAdded.style.display = 'block';
      addStars(starsToAdd, '–ø–æ–ª—É—á–µ–Ω–∏–µ –±–æ–Ω—É—Å–∞');
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–≤–µ—Ä–ª–µ–π –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ
      overlay.style.display = 'block';
      bonusMessage.style.display = 'block';
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ–Ω—É—Å–∞
      lastBonusTime = now;
      localStorage.setItem('lastBonusTime', lastBonusTime);
      
      // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
      updateBonusButton();
    }
    
    // 17.29 –û–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –±–æ–Ω—É—Å–∞
    function updateBonusButton() {
      const now = Date.now();
      const timeLeft = lastBonusTime + BONUS_COOLDOWN - now;
      
      if (timeLeft > 0) {
        const hoursLeft = Math.ceil(timeLeft / (60 * 60 * 1000));
        bonusBtn.innerHTML = `<i class="fas fa-clock"></i> –î–æ –±–æ–Ω—É—Å–∞: ${hoursLeft}—á`;
        bonusBtn.disabled = true;
      } else {
        bonusBtn.innerHTML = '<i class="fas fa-gift"></i> –ü–æ–ª—É—á–∏—Ç—å –±–æ–Ω—É—Å';
        bonusBtn.disabled = false;
      }
    }
    
    // 17.30 –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã (—Å–≤–µ—Ç–ª–∞—è/—Ç—ë–º–Ω–∞—è) —Å –∏–∫–æ–Ω–∫–æ–π
    function toggleTheme() {
      const root = document.documentElement;
      const isLight = root.classList.toggle('light-theme');
      localStorage.setItem('theme', isLight ? 'light' : 'dark');

      // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É
      const themeIcon = document.getElementById('themeIcon');
      if (themeIcon) {
        themeIcon.innerHTML = isLight
          ? '<i class="fas fa-sun"></i>'
          : '<i class="fas fa-moon"></i>';
      }
    }
    
    // 17.31 –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞
    function checkReferral() {
      if (tg && tg.initDataUnsafe && tg.initDataUnsafe.start_param) {
        const refCode = tg.initDataUnsafe.start_param;
        if (refCode && refCode.startsWith('ref')) {
          // –ù–∞—á–∏—Å–ª—è–µ–º –∑–≤–µ–∑–¥—ã –∑–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–Ω–æ–≥–æ –¥—Ä—É–≥–∞
          addStars(5, '–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥—Ä—É–≥–∞');
          showNotification('–í—ã –ø–æ–ª—É—á–∏–ª–∏ 5 –∑–≤–µ–∑–¥ –∑–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–Ω–æ–≥–æ –¥—Ä—É–≥–∞!', 'success');
        }
      }
    }
    
    // 17.32 –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    function initApp() {
      // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–∏–º–µ–Ω—è–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é —Ç–µ–º—É
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'light') {
        document.documentElement.classList.add('light-theme');
      }

      // –ó–∞—Ç–µ–º —Å–æ–∑–¥–∞—ë–º –∑–≤—ë–∑–¥—ã (—Å —É—á—ë—Ç–æ–º —Ç–µ–º—ã)
      createStars();

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∞–Ω–∫–µ—Ç—ã
      const savedData = localStorage.getItem('astroProfileData');
      if (savedData) {
        const data = JSON.parse(savedData);

        // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
        for (const key in data) {
          if (profileForm.elements[key]) {
           profileForm.elements[key].value = data[key];
          }
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ä–µ–∂–∏–º–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
        displayProfileData(data);
        toggleProfileViewMode(false);
      } else {
        // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
        toggleProfileViewMode(true);
      }

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –≥–æ—Ä–æ–¥–∞
      new Awesomplete(document.getElementById('birth_city'), {
        list: ['–ú–æ—Å–∫–≤–∞', '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥', '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫', '–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥', '–ö–∞–∑–∞–Ω—å', '–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥', 
               '–ß–µ–ª—è–±–∏–Ω—Å–∫', '–°–∞–º–∞—Ä–∞', '–û–º—Å–∫', '–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É', '–£—Ñ–∞', '–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫', '–ü–µ—Ä–º—å', '–í–æ—Ä–æ–Ω–µ–∂', 
               '–í–æ–ª–≥–æ–≥—Ä–∞–¥', '–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä', '–°–∞—Ä–∞—Ç–æ–≤', '–¢—é–º–µ–Ω—å', '–¢–æ–ª—å—è—Ç—Ç–∏', '–ò–∂–µ–≤—Å–∫', '–ë–∞—Ä–Ω–∞—É–ª', '–£–ª—å—è–Ω–æ–≤—Å–∫'],
        minChars: 1,
        maxItems: 10
      });

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—á–µ—Ç—á–∏–∫–∞ –∑–≤–µ–∑–¥
      const savedStars = parseInt(localStorage.getItem('starsCount')) || 0;
      starsCount.textContent = savedStars;
      
      // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –±–æ–Ω—É—Å–∞
      updateBonusButton();
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥
      checkReferral();
      
      // –ù–∞—á–∏—Å–ª—è–µ–º –∑–≤–µ–∑–¥—ã –∑–∞ –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
      if (!localStorage.getItem('firstLaunch')) {
        addStars(3, '–ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫');
        localStorage.setItem('firstLaunch', 'true');
      }
      
      // –î–æ–±–∞–≤–ª—è–µ–º –ø—É–ª—å—Å–∞—Ü–∏—é –∫ –∫–Ω–æ–ø–∫–µ –±–æ–Ω—É—Å–∞, –µ—Å–ª–∏ –æ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω
      if (bonusBtn.disabled === false) {
        bonusBtn.classList.add('btn-pulse');
      }
    }

    // 17.33 –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
    profileBtn.addEventListener('click', () => {
      showPanel(profilePanel);
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
      const savedData = localStorage.getItem('astroProfileData');
      if (savedData) {
        // –ï—Å–ª–∏ –µ—Å—Ç—å - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∂–∏–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
        toggleProfileViewMode(false);
      } else {
        // –ï—Å–ª–∏ –Ω–µ—Ç - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
        toggleProfileViewMode(true);
      }
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è
    editProfileBtn.addEventListener('click', () => {
      toggleProfileViewMode(true);
    });
    
    dailyForecastBtn.addEventListener('click', async () => {
      const savedData = localStorage.getItem('astroProfileData');
      if (!savedData) {
        showNotification('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –∞–Ω–∫–µ—Ç—É', 'error');
        showPanel(profilePanel);
        return;
      }
      
      const data = JSON.parse(savedData);
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
      dailyForecastBtn.disabled = true;
      dailyForecastBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞...';
      
      forecastContent.innerHTML = await generateForecast(data, '–¥–µ–Ω—å');
      forecastDate.textContent = `–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ ${new Date().toLocaleDateString('ru-RU')}`;
      showPanel(forecastPanel);
      
      // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–Ω–æ–ø–∫—É –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
      dailyForecastBtn.disabled = false;
      dailyForecastBtn.innerHTML = '<i class="fas fa-sun"></i> –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –¥–µ–Ω—å';
    });
    
    weeklyForecastBtn.addEventListener('click', async () => {
      const savedData = localStorage.getItem('astroProfileData');
      if (!savedData) {
        showNotification('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –∞–Ω–∫–µ—Ç—É', 'error');
        showPanel(profilePanel);
        return;
      }
      
      const data = JSON.parse(savedData);
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
      weeklyForecastBtn.disabled = true;
      weeklyForecastBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞...';
      
      forecastContent.innerHTML = await generateForecast(data, '–Ω–µ–¥–µ–ª—é');
      forecastDate.textContent = `–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –Ω–µ–¥–µ–ª—é ${new Date().toLocaleDateString('ru-RU', { month: 'long', year: 'numeric' })}`;
      showPanel(forecastPanel);
      
      // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–Ω–æ–ø–∫—É –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
      weeklyForecastBtn.disabled = false;
      weeklyForecastBtn.innerHTML = '<i class="fas fa-calendar-week"></i> –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –Ω–µ–¥–µ–ª—é';
    });
    
    monthlyForecastBtn.addEventListener('click', async () => {
      const savedData = localStorage.getItem('astroProfileData');
      if (!savedData) {
        showNotification('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –∞–Ω–∫–µ—Ç—É', 'error');
        showPanel(profilePanel);
        return;
      }
      
      const data = JSON.parse(savedData);
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
      monthlyForecastBtn.disabled = true;
      monthlyForecastBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞...';
      
      forecastContent.innerHTML = await generateForecast(data, '–º–µ—Å—è—Ü');
      forecastDate.textContent = `–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –º–µ—Å—è—Ü ${new Date().toLocaleDateString('ru-RU', { month: 'long', year: 'numeric' })}`;
      showPanel(forecastPanel);
      
      // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–Ω–æ–ø–∫—É –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
      monthlyForecastBtn.disabled = false;
      monthlyForecastBtn.innerHTML = '<i class="fas fa-calendar-alt"></i> –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –º–µ—Å—è—Ü';
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–∞–Ω–µ–ª–µ–π
    closeProfilePanel.addEventListener('click', hideAllPanels);
    closeForecastPanel.addEventListener('click', hideAllPanels);
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —à–∞–≥–æ–≤ –∞–Ω–∫–µ—Ç—ã
    nextStep1.addEventListener('click', () => goToNextStep(1, 2));
    nextStep2.addEventListener('click', () => goToNextStep(2, 3));
    prevStep2.addEventListener('click', () => goToPrevStep(2, 1));
    prevStep3.addEventListener('click', () => goToPrevStep(3, 2));
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∞–Ω–∫–µ—Ç—ã
    profileForm.addEventListener('submit', (e) => {
      e.preventDefault();
      
      if (!profileForm.checkValidity()) {
        showNotification('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
        return;
      }
      
      const formData = new FormData(profileForm);
      const data = Object.fromEntries(formData.entries());
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ localStorage
      localStorage.setItem('astroProfileData', JSON.stringify(data));
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è
      displayProfileData(data);
      
      // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –≤ —Ä–µ–∂–∏–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
      toggleProfileViewMode(false);
      
      // –ù–∞—á–∏—Å–ª—è–µ–º –∑–≤–µ–∑–¥—ã –∑–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–Ω–∫–µ—Ç—ã
      addStars(5, '–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–Ω–∫–µ—Ç—ã');
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
      showNotification('–ê–Ω–∫–µ—Ç–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ (+5 –∑–≤–µ–∑–¥)', 'success');
    });
    
    // –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ Telegram
    document.getElementById('shareTelegram').addEventListener('click', () => {
      const text = `–ú–æ–π –∞—Å—Ç—Ä–æ–ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è:\n${forecastContent.textContent.substring(0, 200)}...\n\n–ü–æ–ª–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ AstroPred!`;
      if (tg && tg.isTelegram) {
        tg.sendData(text);
      } else {
        const url = `https://t.me/share/url?url=${encodeURIComponent(window.location.href)}&text=${encodeURIComponent(text)}`;
        window.open(url, '_blank');
      }
      
      // –ù–∞—á–∏—Å–ª—è–µ–º –∑–≤–µ–∑–¥—ã –∑–∞ —à–∞—Ä–∏–Ω–≥
      addStars(2, '–ø–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–æ–≥–Ω–æ–∑–æ–º');
    });
    
    // –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ WhatsApp
    document.getElementById('shareWhatsApp').addEventListener('click', () => {
      const text = `–ú–æ–π –∞—Å—Ç—Ä–æ–ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è:\n${forecastContent.textContent.substring(0, 200)}...\n\n–ü–æ–ª–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ AstroPred!`;
      const url = `https://wa.me/?text=${encodeURIComponent(text + '\n\n' + window.location.href)}`;
      window.open(url, '_blank');
      
      // –ù–∞—á–∏—Å–ª—è–µ–º –∑–≤–µ–∑–¥—ã –∑–∞ —à–∞—Ä–∏–Ω–≥
      addStars(2, '–ø–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–æ–≥–Ω–æ–∑–æ–º');
    });
    
    // –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
    shareAppBtn.addEventListener('click', () => {
      // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥ –∏–ª–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–π
      let refCode = localStorage.getItem('refCode');
      if (!refCode) {
        const savedData = localStorage.getItem('astroProfileData');
        const name = savedData ? JSON.parse(savedData).name : 'friend';
        refCode = `ref_${name.toLowerCase().replace(/\s+/g, '')}_${Math.floor(1000 + Math.random() * 9000)}`;
        localStorage.setItem('refCode', refCode);
      }
      
      const shareUrl = `https://t.me/astropred_bot?start=${refCode}`;

      if (navigator.share) {
        navigator.share({
          title: 'AstroPred ‚Äî –ê—Å—Ç—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–æ–º–æ—â–Ω–∏–∫',
          text: '–ü–æ–ø—Ä–æ–±—É–π AstroPred ‚Äî —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–∞–≥–∏—á–µ—Å–∫–∏ ‚ú®',
          url: shareUrl
        }).then(() => {
          // –ù–∞—á–∏—Å–ª—è–µ–º –∑–≤–µ–∑–¥—ã –∑–∞ —à–∞—Ä–∏–Ω–≥
          addStars(3, '–ø–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º');
        }).catch(console.error);
      } else if (tg && tg.isTelegram) {
        tg.sendData(shareUrl);
        addStars(3, '–ø–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º');
      } else {
        navigator.clipboard.writeText(shareUrl)
          .then(() => {
            showNotification('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!', 'success');
            addStars(3, '–ø–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º');
          })
          .catch(() => showNotification(`–°—Å—ã–ª–∫–∞ –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è: ${shareUrl}`, 'info'));
      }
    });
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –±–æ–Ω—É—Å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    bonusBtn.addEventListener('click', showRandomBonus);
    
    // –ó–∞–∫—Ä—ã—Ç—å –±–æ–Ω—É—Å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    closeBonusMessage.addEventListener('click', () => {
      overlay.style.display = 'none';
      bonusMessage.style.display = 'none';
    });
    
    // –ó–∞–∫—Ä—ã—Ç—å –±–æ–Ω—É—Å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –æ–≤–µ—Ä–ª–µ–π
    overlay.addEventListener('click', () => {
      overlay.style.display = 'none';
      bonusMessage.style.display = 'none';
    });
    
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã –ø–æ –∫–ª–∏–∫—É –Ω–∞ –ª–æ–≥–æ—Ç–∏–ø
    themeToggle.addEventListener('click', toggleTheme);
    
    // –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    window.addEventListener('load', initApp);
  </script>
</body>
</html>
